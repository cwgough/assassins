{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/cwill/Documents/Assassins/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/cwill/Documents/Assassins/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/cwill/Documents/Assassins/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState,useEffect}from\"react\";import axios from'../api/axios';import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var USER_REGEX=/^[A-z][A-z0-9-_]{3,23}$/;var PWD_REGEX=/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%]).{8,24}$/;var REGISTER_URL='/register';var Register=function Register(){var userRef=useRef();var errRef=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),validName=_useState4[0],setValidName=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),userFocus=_useState6[0],setUserFocus=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPwd=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),validPwd=_useState10[0],setValidPwd=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),pwdFocus=_useState12[0],setPwdFocus=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),matchPwd=_useState14[0],setMatchPwd=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),validMatch=_useState16[0],setValidMatch=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),matchFocus=_useState18[0],setMatchFocus=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),errMsg=_useState20[0],setErrMsg=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),success=_useState22[0],setSuccess=_useState22[1];useEffect(function(){userRef.current.focus();},[]);useEffect(function(){setValidPwd(PWD_REGEX.test(password));setValidMatch(password===matchPwd);},[password,matchPwd]);useEffect(function(){setErrMsg('');},[name,password,matchPwd]);var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var response,_err$response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();// if button enabled with JS hack\n_context.prev=1;_context.next=4;return axios.post(REGISTER_URL,JSON.stringify({name:name,password:password}),{headers:{'Content-Type':'application/json'},withCredentials:true});case 4:response=_context.sent;// TODO: remove console.logs before deployment\n// console.log(JSON.stringify(response?.data));\n//console.log(JSON.stringify(response))\nsetSuccess(true);//clear state and controlled inputs\nsetUser('');setPwd('');setMatchPwd('');_context.next=15;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);if(!(_context.t0!==null&&_context.t0!==void 0&&_context.t0.response)){setErrMsg('No Server Response');}else if(((_err$response=_context.t0.response)===null||_err$response===void 0?void 0:_err$response.status)===409){setErrMsg('Username Taken');}else{setErrMsg('Registration Failed');}errRef.current.focus();case 15:case\"end\":return _context.stop();}},_callee,null,[[1,11]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:success?/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Success!\"}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Sign In\"})})]}):/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"p\",{ref:errRef,className:errMsg?\"errmsg\":\"offscreen\",\"aria-live\":\"assertive\",children:errMsg}),/*#__PURE__*/_jsx(\"h1\",{children:\"Register\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",ref:userRef,autoComplete:\"off\",onChange:function onChange(e){return setUser(e.target.value);},value:name,required:true,\"aria-invalid\":validName?\"false\":\"true\",\"aria-describedby\":\"uidnote\",onFocus:function onFocus(){return setUserFocus(true);},onBlur:function onBlur(){return setUserFocus(false);}}),/*#__PURE__*/_jsx(\"p\",{id:\"uidnote\",className:userFocus&&name&&!validName?\"instructions\":\"offscreen\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",onChange:function onChange(e){return setPwd(e.target.value);},value:password,required:true,\"aria-invalid\":validPwd?\"false\":\"true\",\"aria-describedby\":\"pwdnote\",onFocus:function onFocus(){return setPwdFocus(true);},onBlur:function onBlur(){return setPwdFocus(false);}}),/*#__PURE__*/_jsx(\"p\",{id:\"pwdnote\",className:pwdFocus&&!validPwd?\"instructions\":\"offscreen\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"confirm_pwd\",children:\"Confirm Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"confirm_pwd\",onChange:function onChange(e){return setMatchPwd(e.target.value);},value:matchPwd,required:true,\"aria-invalid\":validMatch?\"false\":\"true\",\"aria-describedby\":\"confirmnote\",onFocus:function onFocus(){return setMatchFocus(true);},onBlur:function onBlur(){return setMatchFocus(false);}}),/*#__PURE__*/_jsx(\"p\",{id:\"confirmnote\",className:matchFocus&&!validMatch?\"instructions\":\"offscreen\",children:\"Must match the first password input field.\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!validMatch?true:false,children:\"Sign Up\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Already registered?\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"line\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Sign In\"})})]})]})});};export default Register;","map":{"version":3,"names":["useRef","useState","useEffect","axios","Link","USER_REGEX","PWD_REGEX","REGISTER_URL","Register","userRef","errRef","name","setUser","validName","setValidName","userFocus","setUserFocus","password","setPwd","validPwd","setValidPwd","pwdFocus","setPwdFocus","matchPwd","setMatchPwd","validMatch","setValidMatch","matchFocus","setMatchFocus","errMsg","setErrMsg","success","setSuccess","current","focus","test","handleSubmit","e","preventDefault","post","JSON","stringify","headers","withCredentials","response","status","target","value"],"sources":["C:/Users/cwill/Documents/Assassins/client/src/components/registerPage.js"],"sourcesContent":["import { useRef, useState, useEffect } from \"react\";\r\nimport axios from '../api/axios';\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst USER_REGEX = /^[A-z][A-z0-9-_]{3,23}$/;\r\nconst PWD_REGEX = /^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%]).{8,24}$/;\r\nconst REGISTER_URL = '/register';\r\n\r\nconst Register = () => {\r\n    const userRef = useRef();\r\n    const errRef = useRef();\r\n\r\n    const [name, setUser] = useState('');\r\n    const [validName, setValidName] = useState(false);\r\n    const [userFocus, setUserFocus] = useState(false);\r\n\r\n    const [password, setPwd] = useState('');\r\n    const [validPwd, setValidPwd] = useState(false);\r\n    const [pwdFocus, setPwdFocus] = useState(false);\r\n\r\n    const [matchPwd, setMatchPwd] = useState('');\r\n    const [validMatch, setValidMatch] = useState(false);\r\n    const [matchFocus, setMatchFocus] = useState(false);\r\n\r\n    const [errMsg, setErrMsg] = useState('');\r\n    const [success, setSuccess] = useState(false);\r\n\r\n    useEffect(() => {\r\n        userRef.current.focus();\r\n    }, [])\r\n\r\n\r\n\r\n    useEffect(() => {\r\n        setValidPwd(PWD_REGEX.test(password));\r\n        setValidMatch(password === matchPwd);\r\n    }, [password, matchPwd])\r\n\r\n    useEffect(() => {\r\n        setErrMsg('');\r\n    }, [name, password, matchPwd])\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        // if button enabled with JS hack\r\n\r\n        try {\r\n            const response = await axios.post(REGISTER_URL,\r\n                JSON.stringify({ name, password }),\r\n                {\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    withCredentials: true\r\n                }\r\n            );\r\n            // TODO: remove console.logs before deployment\r\n            // console.log(JSON.stringify(response?.data));\r\n            //console.log(JSON.stringify(response))\r\n            setSuccess(true);\r\n            //clear state and controlled inputs\r\n            setUser('');\r\n            setPwd('');\r\n            setMatchPwd('');\r\n        } catch (err) {\r\n            if (!err?.response) {\r\n                setErrMsg('No Server Response');\r\n            } else if (err.response?.status === 409) {\r\n                setErrMsg('Username Taken');\r\n            } else {\r\n                setErrMsg('Registration Failed')\r\n            }\r\n            errRef.current.focus();\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {success ? (\r\n                <section>\r\n                    <h1>Success!</h1>\r\n                    <p>\r\n                        <a href=\"/\">Sign In</a>\r\n                    </p>\r\n                </section>\r\n            ) : (\r\n                <section>\r\n                    <p ref={errRef} className={errMsg ? \"errmsg\" : \"offscreen\"} aria-live=\"assertive\">{errMsg}</p>\r\n                    <h1>Register</h1>\r\n                    <form onSubmit={handleSubmit}>\r\n                        <input\r\n                            type=\"text\"\r\n                            id=\"username\"\r\n                            ref={userRef}\r\n                            autoComplete=\"off\"\r\n                            onChange={(e) => setUser(e.target.value)}\r\n                            value={name}\r\n                            required\r\n                            aria-invalid={validName ? \"false\" : \"true\"}\r\n                            aria-describedby=\"uidnote\"\r\n                            onFocus={() => setUserFocus(true)}\r\n                            onBlur={() => setUserFocus(false)}\r\n                        />\r\n                        <p id=\"uidnote\" className={userFocus && name && !validName ? \"instructions\" : \"offscreen\"}>\r\n                        </p>\r\n\r\n\r\n                        <label htmlFor=\"password\">\r\n                            Password:\r\n                        </label>\r\n                        <input\r\n                            type=\"password\"\r\n                            id=\"password\"\r\n                            onChange={(e) => setPwd(e.target.value)}\r\n                            value={password}\r\n                            required\r\n                            aria-invalid={validPwd ? \"false\" : \"true\"}\r\n                            aria-describedby=\"pwdnote\"\r\n                            onFocus={() => setPwdFocus(true)}\r\n                            onBlur={() => setPwdFocus(false)}\r\n                        />\r\n                        <p id=\"pwdnote\" className={pwdFocus && !validPwd ? \"instructions\" : \"offscreen\"}>\r\n\r\n                        </p>\r\n\r\n\r\n                        <label htmlFor=\"confirm_pwd\">\r\n                            Confirm Password:\r\n                        </label>\r\n                        <input\r\n                            type=\"password\"\r\n                            id=\"confirm_pwd\"\r\n                            onChange={(e) => setMatchPwd(e.target.value)}\r\n                            value={matchPwd}\r\n                            required\r\n                            aria-invalid={validMatch ? \"false\" : \"true\"}\r\n                            aria-describedby=\"confirmnote\"\r\n                            onFocus={() => setMatchFocus(true)}\r\n                            onBlur={() => setMatchFocus(false)}\r\n                        />\r\n                        <p id=\"confirmnote\" className={matchFocus && !validMatch ? \"instructions\" : \"offscreen\"}>\r\n                            Must match the first password input field.\r\n                        </p>\r\n\r\n                        <button disabled={!validMatch ? true : false}>Sign Up</button>\r\n                    </form>\r\n                    <p>\r\n                        Already registered?<br />\r\n                        <span className=\"line\">\r\n                            <a href=\"/\">Sign In</a>\r\n                        </span>\r\n                    </p>\r\n                </section>\r\n            )}\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Register"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}